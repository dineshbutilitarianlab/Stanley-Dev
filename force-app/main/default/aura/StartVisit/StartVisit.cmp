<aura:component controller="TodayTaskAuraController" implements="force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,force:lightningQuickAction" access="global" >
    <aura:attribute name="atr1" type="string" />
    <aura:handler name="init" value="{!this}" action="{!c.doInit}"/>
    <aura:attribute name="accountId" type="String"/>
    <aura:attribute name="sepcifierId" type="String"/>
    <aura:attribute name="spinner" type="boolean" default="false"/>
    <aura:attribute name="showPopupModal" type="boolean" default="false"/>
    <aura:attribute name="showPopupVisitUpdateStatus" type="boolean" default="false"/>
    
    <aura:attribute name="siteURL" type="String"/> 
    <aura:attribute name="showCreateTask" type="boolean" default="false"/>
    <aura:attribute name="showCreateCallLogTask" type="boolean" default="false"/>
    <aura:attribute name="showCreateCase" type="boolean" default="false"/>
    <aura:attribute name="showOpportunityCreate" type="boolean" default="false"/>
    <aura:attribute name="StatuspickValues" type="List" default="['Not Started', 'In Progress', 'Completed']" />
    <aura:attribute name="PrioritypickValues" type="List" default="['High', 'Normal', 'Low']" />
    <aura:attribute name="CaseStatuspickValues" type="List" default="['New', 'Working', 'Escalated', 'Closed']" />
    <aura:attribute name="OppStageNamepickValues" type="List" default="['New', 'Working', 'Escalated', 'Closed']" />
    <aura:attribute name="selectedValue" type="String"/>
    <aura:attribute name="currentLongitudeNew" type="String"/>
    <aura:attribute name="currentLatitudeNew" type="String"/>
    <aura:attribute name="accountAddress" type="String"/>
    <aura:attribute name="taskRec" type="sObject" default="{sObjectType: 'Task'}"/>
    <aura:attribute name="callRec" type="sObject" default="{sObjectType: 'Task'}"/>
    <aura:attribute name="oppRec" type="sObject" default="{sObjectType: 'Opportunity'}" />
    <aura:attribute name="caseRec" type="sObject" default="{sObjectType: 'Case'}" />
    <aura:attribute name="visitRec" type="sObject" default="{sObjectType: 'Visit__c'}" />
    <aura:attribute name="newLeadRec" type="sObject" default="{sObjectType: 'Lead'}" />
    <aura:attribute name="newChildVisitRec" type="sObject" default="{sObjectType: 'Visit__c'}" />
    <aura:attribute name="accID" type="String" />
    <aura:attribute name="visitId" type="String" />
    <aura:attribute name="ParentVisitName" type="String" />
    <aura:attribute name="ShowCheckInButton" type="Boolean" default = "false"/>
    <aura:attribute name="ShowCheckOutButton" type="Boolean" default = "true"/>
    <aura:attribute name="pastVisitList" type="List" />
    <aura:attribute name="relOppList" type="List" />
    
    <aura:attribute name="relSampleList" type="List" />
    <aura:attribute name="relProjectList" type="List" />
    
    <aura:attribute name="relInvoicesList" type="List" />
    <aura:attribute name="relCaseList" type="List" />
    <aura:attribute name="relActivityList" type="List" />
    <aura:attribute name="currentLatitude" type="String"/>
    <aura:attribute name="currentLongitude" type="String"/>
    <lightning:navigation aura:id="navService" />
    
    <aura:attribute name="fields" type="String[]"  />
    <aura:attribute name="SobjectApiName" type="String" />
    <aura:attribute name="ShowModal" type="boolean" default="false" />
    <aura:attribute name="url" type="String"/>
    <aura:attribute name="pageReference" type="Object"/>
    <lightning:pageReferenceUtils aura:id="pageRefUtils"/>
    <aura:attribute name="ShowUpdateVisitPage" type="boolean" default="false"/>
    <aura:attribute name="logMomDescription" type="String"/>
    <aura:attribute name="logMomSubject" type="String"/>
    <aura:attribute name="stackEmail" type="String"/>
    <aura:attribute name="auraUserId" type="String" />
     <aura:attribute name="showGenerateLeadPage" type="boolean" default="false"/>
     <aura:attribute name="showNextVisitPage" type="boolean" default="false"/>
     <aura:attribute name="defaultAssignedUserForNextVisit" type="boolean" default="false"/>
     <aura:attribute name="defaultLogInUserId" type="String" />
    <!-- Added by Anjali -->
    <aura:attribute name="showAddressPage" type="boolean" default="true" />
    
    <aura:attribute name="ship_addresses" type="List" />
    <aura:attribute name="bill_addresses" type="List" />
    
    <aura:attribute name="selectedBilAddressIndex" type="Integer" />
    <aura:attribute name="checkedBillAdd" type="Boolean" />
    <aura:attribute name="selectedAddressIndex" type="Integer" />
    <aura:attribute name="checkedShipAdd" type="Boolean" />
    
    <aura:attribute name="billCity" type="String" />
    <aura:attribute name="billStreet" type="String" />
    <aura:attribute name="billState" type="String" />
    <aura:attribute name="billCountry" type="String" />
    <aura:attribute name="billPostalCode" type="String" />
    
    <aura:attribute name="shipCity" type="String" />
    <aura:attribute name="shipStreet" type="String" />
    <aura:attribute name="shipState" type="String" />
    <aura:attribute name="shipCountry" type="String" />
    <aura:attribute name="shipPostalCode" type="String" />
    
    <aura:attribute name="accShipAdrs" type="Boolean" />
    <aura:attribute name="customShipAdrsId" type="String" />
    <aura:attribute name="accBillAdrs" type="Boolean" />
    <aura:attribute name="customBillAdrsId" type="String" />
    <aura:registerEvent name="fieldVisitComponentEvent" type="c:fieldVisitComponentEvent"/>

    <!-- Added New Variable for Making Standard funcationality into Custom - Dinesh -->
    <aura:attribute name="VisitStautspickValues" type="List"/>
    <aura:attribute name="LeadBDCategorypickValues" type="List"/>
    <aura:attribute name="LeadCityLocationpickValues" type="List"/>
    <aura:attribute name="LeadStatuspickValues" type="List"/>
    <aura:attribute name="LeadTypepickValues" type="List"/>
    
    <aura:html tag="style">
        .slds-modal__container { 
        width : 84% !important; max-width : 84% !important; 
        } 
    </aura:html>
    
    <!--loading spinner start-->
    <aura:if isTrue="{!v.spinner}">
        <div aura:id="spinnerId" class="slds-spinner_container">
            <div class="slds-spinner--brand  slds-spinner slds-spinner--large slds-is-relative" role="alert">
                <span class="slds-assistive-text">Loading...</span>
                <div class="slds-spinner__dot-a"></div>
                <div class="slds-spinner__dot-b"></div>
            </div>
        </div>
    </aura:if>
    <!-- Loading spinner end-->   
    
     <!-- Check in Popup-->
    <aura:if isTrue="{!v.showPopupModal}">
        <section  role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-align_absolute-center ">
            <div class="slds-modal__container checkBox"> 
                <!--Modal/Popup Box Body Starts here-->
                <div class="slds-modal__content slds-p-around_small " id="modal-content-id-1">
                    <p> <b>Check-In?</b> </p>
                </div>
                <!--Modal/Popup Box Footer Starts here-->
                <footer class="slds-modal__footer">
                    <lightning:button variant="neutral"
                                      label="No"
                                      title="No"
                                      onclick="{! c.closeModalPopup }"/>
                    <lightning:button variant="brand"
                                      label="Yes"
                                      title="Yes"
                                      onclick="{!c.checkInHandler}"/>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </aura:if>
    
    <!-- FinalVisitUpdateStatusPopUp-->
    <aura:if isTrue="{!v.showPopupVisitUpdateStatus}">
     <div class="slds-m-around_large">
     <lightning:button variant="brand" label="What is Modal/PopUp Box?" onclick="{!c.openModel}" />
      <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">
            <header class="slds-modal__header">
                <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeModel}" alternativeText="close" variant="bare-inverse" class="slds-modal__close"/>
                <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"><b>Update Final Visit Status</b></h2>
            </header>
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">   
                <div class="slds-grid">
                    <div class="slds-col slds-text-align_center">
                        <lightning:button label="Lead Generated" onclick="{!c.OpenLeadGenerateModel}" class="slds-button slds-button_brand  custmFinalVisitUpdateBtn"/>
                         <lightning:button label="Schedule Next Visit" onclick="{!c.OpenNextVisitModal}" class="slds-button slds-button_brand custmFinalVisitUpdateBtn"/>
                    </div>
                </div>
            </div>
            <footer class="slds-modal__footer ">
                <lightning:button class="slds-align_absolute-center" variant="destructive" label="Cancel" onclick="{!c.closeModel}" />
            </footer>
        </div>
      </section>
      <div class="slds-backdrop slds-backdrop_open"></div>
      </div>
    </aura:if>

     <!--NextVisitPage-->
     <aura:if isTrue="{!v.showNextVisitPage}">
        <div>
            <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <div class="slds-modal__header">
                        <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeModelGenerateLead}" alternativeText="close" variant="bare-inverse" class="slds-modal__close"/>
                    </div>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div class="slds-border_bottom slds-align_absolute-center">
                            <h1 style="font-size:20px;">Schedule Next Visit</h1>
                        </div><br/>                            
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                     <lightning:input aura:id="plannedVisitDate" type="date" label="Planned Visit Date" value="{!v.newChildVisitRec.Planned_visit_date__c}" />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input aura:id="visitdescription" label="Description" value="{!v.newChildVisitRec.Description__c}" />
                                </div>
                            </div>
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input aura:id="expectedStartTime" type="time" label="Start Time" value="{!v.newChildVisitRec.Expected_Start_Time__c}" />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input aura:id="expectedEndTime" type="time" label="End Time" value="{!v.newChildVisitRec.Expected_End_Time__c}" />
                                </div>
                            </div>
                            <aura:if isTrue="{!v.defaultAssignedUserForNextVisit}">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:inputField fieldName="Assigned_User__c" value="{!v.defaultLogInUserId}" disabled="true"  /> 
                               </div>
                             </aura:if>                            
                             <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                     <lightning:input aura:id="visitdescription" label="Parent Visit" value="{!v.ParentVisitName}" disabled="true" />
                                </div>
                                 <div class="slds-col slds-size_1-of-2">
                                     <lightning:input aura:id="visitspecifier" label="Specifier Name" value="{!v.visitRec.Specifier__r.Name}"  disabled="true" />
                                 </div>
                            </div>
                          <br/>
                            <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                <span style="margin-right: 40px;">
                                    <lightning:button label="Back"  variant="destructive" onclick="{!c.GoBackToFinalVisitStausScreen}" class="slds-m-top_small slds-m-right_small" />
                                </span>
                                <lightning:button label="Save" variant="brand" onclick="{!c.createChildVisit}" class="slds-m-top_small slds-m-left_small" />
                            </div>
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
    </aura:if>
       
    <!--New Lead Page-->
    <aura:if isTrue="{!v.showGenerateLeadPage}">
        <div>
            <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
                <div class="slds-modal__container">
                    <div class="slds-modal__header">
                        <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeModelGenerateLead}" alternativeText="close" variant="bare-inverse" class="slds-modal__close"/>
                    </div>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div class="slds-border_bottom slds-align_absolute-center">
                            <h1 style="font-size:20px;">New Lead</h1>
                        </div><br/>                            
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                     <lightning:input name="leadname" required="true" value="{!v.newLeadRec.LastName}" placeholder="Enter Name" label="Name"  />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input name="leadcompany" required="true" value="{!v.newLeadRec.Company}" placeholder="Enter Firm Name" label="Firm Name" />
                                </div>
                            </div>
                             <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:select aura:id="leadbdcategorystatus" label="Select Catogory"  onchange="{!c.onChangeBdCategoryHandler}">
                                        <option value="">--None--</option>
                                        <aura:iteration items="{!v.LeadBDCategorypickValues}" var="val">
                                            <option value="{!val}"> {!val}</option>
                                        </aura:iteration>
                                    </lightning:select>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:select aura:id="leadcitylocation" label="Select City"  onchange="{!c.onChangeLeadCityLocationHandler}">
                                        <option value="">--None--</option>
                                        <aura:iteration items="{!v.LeadCityLocationpickValues}" var="val">
                                            <option value="{!val}"> {!val}</option>
                                        </aura:iteration>
                                    </lightning:select>
                                </div>
                            </div>
                            
                             <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input name="leadresponsible" value="{!v.newLeadRec.Responsible__c}" placeholder="Enter Text" label="Responsible"  />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:select aura:id="leadstatus" label="Select Status"  onchange="{!c.onChangeLeadStatusHandler}">
                                        <option value="">--None--</option>
                                        <aura:iteration items="{!v.LeadStatuspickValues}" var="val">
                                            <option value="{!val}"> {!val}</option>
                                        </aura:iteration>
                                    </lightning:select>
                                </div>
                            </div>
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                   <lightning:input aura:id="estimateddateofquote" type="date" label="Estimated Date of Quote" value="{!v.newLeadRec.Estimated_Date_of_Quote__c}" />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input type="number" label="Approx Value" value="{!v.newLeadRec.Approx_Value__c}" onchange="{!c.handleApproxValueChange}" step="0.01" formatter="currency"/>
                                </div>
                            </div>
                             <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                     <lightning:input name="leaddescription"  value="{!v.newLeadRec.Description}" placeholder="Enter Description" label="Description" />
                                </div>
                                 <div class="slds-col slds-size_1-of-2">
                                     <lightning:input type="text" name="leadspecifier" disabled ="true" value="{!v.newLeadRec.Specifier__c}"  label="Specifier Name" />
                                 </div>
                            </div>
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                  <lightning:select aura:id="leadtype" label="Select Type"  onchange="{!c.onChangeLeadTypeHandler}">
                                    <option value="">--None--</option>
                                    <aura:iteration items="{!v.LeadTypepickValues}" var="val">
                                        <option value="{!val}"> {!val}</option>
                                    </aura:iteration>
                                </lightning:select>
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input aura:id="followupdatetime" type="datetime" label="Follow Up DateTime" value="{!v.newLeadRec.Follow_Up_Date_Time__c}" />
                                </div>
                            </div>
                            <div class="slds-grid slds-gutters">
                                <div class="slds-col slds-size_1-of-2">
                                    <lightning:input name="leaddetails"  value="{!v.newLeadRec.Lead_Details__c}" placeholder="Enter Lead Details" label="Lead Details" />
                                </div>
                                <div class="slds-col slds-size_1-of-2">
                                     <lightning:input name="leadaction"  value="{!v.newLeadRec.Action__c}" placeholder="Enter Action" label="Action" />
                                </div>
                            </div>
                            <br/>
                            <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                <span style="margin-right: 40px;">
                                    <lightning:button label="Back"  variant="destructive" onclick="{!c.GoBackToFinalVisitStausScreen}" class="slds-m-top_small slds-m-right_small" />
                                </span>
                                <lightning:button label="Save" variant="brand" onclick="{!c.createNewLeadRecord}" class="slds-m-top_small slds-m-left_small" />
                            </div>
 
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open"></div>
        </div>
    </aura:if>
    
    <lightning:Layout multipleRows="true">
        <!--div style="margin-top:1%"-->
        <lightning:LayoutItem padding="horizontal-small" size="8" class="headerStartVisitPage">
            <div class="page-section DesktopHeader page-header">
                <lightning:Layout>
                    <lightning:LayoutItem size="2">
                        <div style="padding:3%; position:relative; top:-27%; display:inline-block;">
                            <lightning:icon variant="inverse" iconName="utility:back" alternativeText="Utility image" title="Image" onclick="{!c.goBackOnePage}" style="cursor: pointer;"/>
                        </div>
                        <div style="padding:3%; position:relative;margin-left:2%; top:-27%; display:inline-block;">
                            <lightning:icon variant="inverse" iconName="standard:contact_list" alternativeText="Utility image" title="Image" />
                        </div>
                    </lightning:LayoutItem>
                    <lightning:LayoutItem size="10">
                        <div style="padding:0%;margin-left:-4%; position:relative; top:-18%; display:inline-block;"><h1 style="color:white; font-size:170%;">
                            <aura:if isTrue="{!v.visitRec.Account__c != null}">
                                {!v.visitRec.Account__r.Name}
                                <aura:set attribute="else">
                                    {!v.visitRec.Lead__r.Name}
                                </aura:set>
                            </aura:if>
                            </h1></div>
                    </lightning:LayoutItem>
                </lightning:Layout>
            </div>
        </lightning:LayoutItem>
        <!--Mobile view header-->
        <div class="mobileHeader">
            <div style="padding:3%; position:relative; top:-27%; display:none">
                <lightning:icon iconName='utility:back' alternativeText='back' size='small' title='back' onclick="{!c.goBackOnePage}"/>&nbsp;<h1>Back</h1>
            </div>
            <div class="checkinButton" style="">
                <lightning:button onclick="{!c.checkInHandler}" label="Check-In" disabled="{!v.ShowCheckInButton}" class="visitCheckInButtons"/>
                <lightning:button onclick="{!c.checkOutHandler}" label="Check-Out" disabled="{!v.ShowCheckOutButton}" class="visitCheckInButtons"/>
                <lightning:button onclick="{!c.UpdateVisitDetails}" label="Update Visit" class="visitCheckInButtons"/>
            </div>
        </div>
        
        <lightning:LayoutItem padding="horizontal-small" size="8">
            <div class="DesktopCard">
                <lightning:LayoutItem size="12">
                    <lightning:card>
                        <lightning:Layout>
                            <lightning:LayoutItem size="12">
                                
                                <lightning:Layout>
                                    <lightning:LayoutItem  size="3">
                                        <div style=" padding-left: 12%; padding-bottom: 5%; justify-content: flex-start; align-items: center; gap: 4px;  color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block;">Beat Id:</div>
                                        <div style=" padding-left: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block;">{!v.visitRec.Name}</div>
                                    </lightning:LayoutItem>
                                    <lightning:LayoutItem size="6">
                                        <div style=" padding-left: 12%; padding-bottom: 5%; justify-content: flex-start; align-items: center; gap: 4px;  color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block;">Website:</div>
                                        <div style=" padding-left: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block;">
                                            <aura:if isTrue="{!v.visitRec.Account__c != null}">
                                                {!v.visitRec.Account__r.Website}
                                                <aura:set attribute="else">
                                                    {!v.visitRec.Lead__r.Website}
                                                </aura:set>
                                            </aura:if>
                                        </div>
                                    </lightning:LayoutItem>
                                    <lightning:LayoutItem size="3">
                                        <div style=" padding-left: 12%; padding-bottom: 5%; justify-content: flex-start; align-items: center; gap: 4px;  color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block;">Phone:</div>
                                        <div style=" padding-left: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block;">
                                            <aura:if isTrue="{!v.visitRec.Account__c != null}">
                                                {!v.visitRec.Account__r.Phone}
                                                <aura:set attribute="else">
                                                    {!v.visitRec.Lead__r.Phone}
                                                </aura:set>
                                            </aura:if>
                                            <aura:if isTrue="{!v.visitRec.Specifier__c != null}">
                                                {!v.visitRec.Specifier__r.Phone}
                                            </aura:if>
                                        </div>
                                    </lightning:LayoutItem>
                                </lightning:Layout>
                            </lightning:LayoutItem>
                        </lightning:Layout>
                        
                        <lightning:Layout>
                            <lightning:LayoutItem size="12">
                                <lightning:Layout>
                                    <lightning:LayoutItem  size="3">
                                        <div style=" padding-left: 12%; padding-bottom: 1%; justify-content: flex-start; align-items: center; gap: 4px;  color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block;">Email:</div>
                                        <div style=" padding-left: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block;">
                                            <aura:if isTrue="{!v.visitRec.Account__c != null}">
                                                {!v.visitRec.Account__r.Email__c}
                                                <aura:set attribute="else">
                                                    {!v.visitRec.Lead__r.Email}
                                                </aura:set>
                                            </aura:if>
                                            <aura:if isTrue="{!v.visitRec.Specifier__c != null}">
                                                {!v.visitRec.Specifier__r.Email}
                                            </aura:if>
                                        </div>
                                    </lightning:LayoutItem>
                                    <lightning:LayoutItem size="6">
                                        <div style="display: flex; align-items: center;">
                                            <div style="padding-left: 12%; padding-bottom: 1%; justify-content: flex-start; align-items: center; gap: 4px; color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block; position: relative; top: -46%;">Address:</div>
                                            <div style="padding-left: 1%; padding-bottom: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block; max-width: 76%;">{!v.accountAddress}</div>
                                        </div>                                        
                                    </lightning:LayoutItem>
                                    <lightning:LayoutItem size="3">
                                        <div style=" padding-left: 12%; justify-content: flex-start; align-items: center; gap: 4px;  color: black; font-size: 12px; font-family: Lato; font-weight: 600; word-wrap: break-word; display: inline-block;">Visit Time:</div>
                                        <div style=" padding-left: 1%; justify-content: flex-start; color: #7D7D7D; font-size: 12px; font-family: Lato; font-weight: 400; word-wrap: break-word; display: inline-block;">
                                            <aura:if isTrue="{!v.visitRec.Specifier__c != null}">
                                                {!v.visitRec.Expected_Start_Time__c}
                                                <aura:set attribute="else">
                                                    {!v.visitRec.Visit_Time__c}
                                                </aura:set>
                                            </aura:if>
                                        </div>
                                    </lightning:LayoutItem>
                                </lightning:Layout>
                                
                            </lightning:LayoutItem>
                        </lightning:Layout>
                    </lightning:card>
                </lightning:LayoutItem>
            </div>
        </lightning:LayoutItem>
        
        <!--Map Card show CSS for Mobile-->
        <div class="mapCardMobile">
            <div class="slds-card ">
                <c:mapcontainer recordId="{!v.accID}"  class="map"/>
            </div>
        </div>
        
        <!--Card show CSS for Mobile-->
        <div class="MobileCard">
            <div class="slds-card ">
                <div style="padding:3%; position:relative;margin-left:2%; top:-27%; display:inline-block;">
                    <lightning:icon class="floatingButton" variant="inverse" iconName="standard:contact_list" alternativeText="Utility image" title="Image" size="medium"/>
                </div>
                <div style="padding:0%; position:relative; top:-18%; display:inline-block;"><h1 style="color:black;font-size: 125%;font-weight: 500;">{!v.visitRec.Account__r.Name}</h1></div>
                <div class="cardInfo">
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Beat Id &nbsp;:</b>&nbsp;{!v.visitRec.Name}</div>
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Website &nbsp;:</b>&nbsp;{!v.visitRec.Account__r.Website}</div>
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Phone &nbsp;:</b>&nbsp;{!v.visitRec.Account__r.Phone}</div>
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Email &nbsp;:</b>&nbsp;{!v.visitRec.Account__r.Email__c}</div>
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Address &nbsp;:</b>&nbsp;{!v.accountAddress}</div>
                    <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Time &nbsp;:</b>&nbsp;{!v.visitRec.Account__r.Visit_Time__c}</div>
                </div>
            </div>
        </div>
        
        <!--Button Group Card show CSS for Mobile-->
        <div class="buttonGroupCardMobile">
            <div class="slds-card ">
                <div class="">
                    <aura:if isTrue="{!v.ShowModal}">
                        
                        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
                            <div class="slds-modal__container">
                                <div class="slds-modal__header">
                                    <lightning:buttonIcon iconName="utility:close"
                                                          onclick="{! c.closeModel }"
                                                          alternativeText="close"
                                                          variant="bare-inverse"
                                                          class="slds-modal__close"/>
                                </div>
                                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                    
                                    <!--AddressPage1-->
                                    <aura:if isTrue="{!v.showAddressPage}">
                                        <h3>Shipping Address</h3><br/>
                                        <div class="slds-scrollable_x">
                                            <table class="slds-table slds-table_bordered slds-table_col-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Select</th>
                                                        <th>Address Type</th>
                                                        <th>Street</th>
                                                        <th>City</th>
                                                        <th>State</th>
                                                        <th>Country</th>
                                                        <th>Pin Code</th>
                                                        <th>GST Number</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.ship_addresses}" var="address" indexVar="index">
                                                        <tr key="{!address.id}">
                                                            <td>
                                                                <input type="radio" id="{!address.id}" name="shippingOptions" checked="{!address.checked}" onclick="{!c.onAddressSelect}"  />
                                                            </td>
                                                            <td>{!address.type}</td>
                                                            <td>{!address.street}</td>
                                                            <td>{!address.city}</td>
                                                            <td>{!address.state}</td>
                                                            <td>{!address.country}</td>
                                                            <td>{!address.postalCode}</td>
                                                            <td>{!address.gstNumber}</td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Rendering the Billing Addresses -->
                                        <br/><br/>
                                        <h3>Billing Address</h3><br />
                                        <div class="slds-scrollable_x">
                                            <table class="slds-table slds-table_bordered slds-table_col-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Select</th>
                                                        <th>Address Type</th>
                                                        <th>Street</th>
                                                        <th>City</th>
                                                        <th>State</th>
                                                        <th>Country</th>
                                                        <th>Pin Code</th>
                                                        <th>GST Number</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.bill_addresses}" var="address" indexVar="index">
                                                        <tr key="{!address.id}">
                                                            <td>
                                                                <input type="radio" id="{!address.id}" name="billingOptions" checked="{!address.checked}" onclick="{!c.onBillAddressSelect}"  />
                                                            </td>
                                                            <td>{!address.type}</td>
                                                            <td>{!address.street}</td>
                                                            <td>{!address.city}</td>
                                                            <td>{!address.state}</td>
                                                            <td>{!address.country}</td>
                                                            <td>{!address.postalCode}</td>
                                                            <td>{!address.gstNumber}</td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Next Button -->
                                        <br/>
                                        <div class="slds-clearfix">
                                            <div class="slds-float_right">
                                                <lightning:button variant="brand" label="Next" class="slds-m-left_x-small" onclick="{!c.handleNavigate}" />
                                            </div>
                                        </div>
                                        <!--OpportunityCreatePage1-->
                                        <aura:set attribute="else">
                                            <div class="slds-border_bottom slds-align_absolute-center">
                                                <h1 style="font-size:20px;">Create Opportunity</h1>
                                            </div><br/>
                                            <lightning:recordEditForm aura:id="recordMOppEditForm"  objectApiName="Opportunity"  onerror="{!c.handleError}" onsuccess="{!c.handleOppSuccess}" >
                                                
                                                <div class="slds-grid">
                                                    <div class="slds-col slds-size_2-of-2">
                                                        <lightning:inputField fieldName="Name" value="{!v.visitRec.Account__r.Name + ' - Opportunity'}"/>
                                                        <lightning:inputField fieldName="Visit__c" value="{!v.visitRec.Id}"/>
                                                        <lightning:inputField fieldName="AccountId" value="{!v.visitRec.Account__c}"/>
                                                        <lightning:inputField fieldName="CloseDate"/>
                                                        <lightning:inputField fieldName="StageName" value="New"/>
                                                        <lightning:inputField fieldName="End_Use_Category__c"/>
                                                        <lightning:inputField fieldName="End_Use_Application__c" />                
                                                        <lightning:inputField fieldName="End_Use_Application_Other__c"/>
                                                        <lightning:inputField fieldName="LeadSource" />
                                                        <lightning:inputField fieldName="Client_Note__c"/>
                                                        <lightning:inputField fieldName="CurrencyIsoCode"/>
                                                        <lightning:inputField fieldName="Sales_Note__c" />
                                                        <lightning:inputField fieldName="Annual_Volume_in_units__c"/>
                                                        <lightning:inputField fieldName="Annual_Volume_Full__c" />                
                                                        <lightning:inputField fieldName="Target_Price_Kg__c" />
                                                        <lightning:inputField fieldName="Primary_Contact__c" value="{!v.visitRec.Account__r.Customer_Contact__c}"/>
                                                        <lightning:inputField fieldName="Customer_Followup_Date__c"/>
                                                        <lightning:inputField fieldName="Customer_response__c"/>
                                                        <lightning:inputField fieldName="NextStep"/>
                                                        <lightning:inputField fieldName="Description"/>
                                                        
                                                        <lightning:inputField fieldName="Shipping_City__c" value="{!v.shipCity}"/>
                                                        <lightning:inputField fieldName="Shipping_State__c" value="{!v.shipState}"/>
                                                        <lightning:inputField fieldName="Shipping_Street__c" value="{!v.shipStreet}"/>
                                                        <lightning:inputField fieldName="Shipping_Country__c" value="{!v.shipCountry}"/>
                                                        <lightning:inputField fieldName="Shipping_Postal_Code__c" value="{!v.shipPostalCode}"/>
                                                        <!-- Address Information -->
                                                        <lightning:inputField fieldName="Billing_City__c" value="{!v.billCity}"/>
                                                        <lightning:inputField fieldName="Billing_State__c" value="{!v.billState}"/>
                                                        <lightning:inputField fieldName="Billing_Street__c" value="{!v.billStreet}"/>
                                                        <lightning:inputField fieldName="Billing_Country__c" value="{!v.billCountry}"/>
                                                        <lightning:inputField fieldName="Billing_Postal_Code__c" value="{!v.billPostalCode}"/>  
                                                        
                                                        <lightning:inputField fieldName="Customer_Shipping_Address__c" value="{!v.customShipAdrsId}"/>
                                                        <lightning:inputField fieldName="Account_Shipping_Address__c" value="{!v.accShipAdrs}"/>
                                                        <lightning:inputField fieldName="Customer_Billing_Address__c" value="{!v.customBillAdrsId}"/>
                                                        <lightning:inputField fieldName="Account_Billing_Address__c" value="{!v.accBillAdrs}"/>
                                                    </div> 
                                                    
                                                </div>
                                                <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                                    <lightning:button label="Cancel" onclick="{!c.onCancel}" class="slds-m-top_small" />
                                                    <lightning:button label="Save" variant="brand" onclick="{!c.handleMOppSubmit}" class="slds-m-top_small" />
                                                </div>  
                                            </lightning:recordEditForm> 
                                        </aura:set>
                                        
                                    </aura:if>               
                                    
                                </div>
                            </div>
                        </section>
                        
                        <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>   
                    </aura:if>
                </div>
                
                <div class="firstbutton">
                    <ul class="slds-button-group-row">
                        <aura:if isTrue="{!v.visitRec.Account__c != null}">
                            <li class="slds-button-group-item">
                                <lightning:button onclick="{!c.createOpportunityHandle}" label="New Opportunity" class="visitMainButtons"/>
                            </li>
                        </aura:if>
                        <aura:if isTrue="{!v.visitRec.Account__c != null}">
                            <li class="slds-button-group-item">
                                <lightning:button onclick="{!c.createCaseHanlde}" label="New Ticket" class="visitMainButtonsSecond"/>
                            </li>
                        </aura:if>
                    </ul>
                </div>
                
<!--                 
                <div class="secondbutton">
                    <ul class="slds-button-group-row">
                        
                        <li class="slds-button-group-item">
                            <lightning:button onclick="{!c.createTaskHanlde}" label="Log an Activity" class="visitMainButtonsSecond"/>
                        </li>
                        <li class="slds-button-group-item">
                            <lightning:button onclick="{!c.createTaskForMOM}" label="Log MOM" class="visitMainButtonsSecond"/>
                        </li>
                    </ul>
                </div> -->
                <div class="secondbutton">
                    <ul class="slds-button-group-row">
                        
                    </ul>
                </div>
                
                <lightning:tabset>
                    
                    <!--TabActivity1-->
                    <lightning:tab label="Activity">
                        <div class="dataTableMobile">
                            <aura:iteration items="{!v.relActivityList}"  var="pastVisitRec" indexVar="index">
                                <div class="slds-card cardmargin">
                                    <div class="cardInfo">
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Due Date &nbsp;:</b>&nbsp;{!pastVisitRec.ActivityDate}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Priority &nbsp;:</b>&nbsp;{!pastVisitRec.Priority}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Status &nbsp;:</b>&nbsp;{!pastVisitRec.Status}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Subject &nbsp;:</b>&nbsp;{!pastVisitRec.Subject}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Type &nbsp;:</b>&nbsp; {!pastVisitRec.Type}</div>
                                    </div>
                                </div>
                            </aura:iteration>
                        </div>
                    </lightning:tab>
                    
                    <!--TabPastVisits1-->
                    <lightning:tab label="Past Visits">
                        <div class="dataTableMobile">
                            <aura:iteration items="{!v.pastVisitList}"  var="pastVisitRec" indexVar="index">
                                <div class="slds-card cardmargin">
                                    <div class="cardInfo">
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Type &nbsp;:</b>&nbsp;{!pastVisitRec.KPI_Target_Name__c}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Id &nbsp;:</b>&nbsp;{!pastVisitRec.Name}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Date &nbsp;:</b>&nbsp;{!pastVisitRec.Actual_visit_date__c}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Duration &nbsp;:</b>&nbsp;{!pastVisitRec.Duration__c}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Time &nbsp;:</b>&nbsp; {!pastVisitRec.Visit_Time__c}</div>
                                        <div class="slds-text-align_left slds-has-flexi-truncate"><b>Visit Status &nbsp;:</b>&nbsp; {!pastVisitRec.Visit_Status__c}</div>
                                    </div>
                                </div>
                            </aura:iteration>
                        </div>
                    </lightning:tab>
                    
                    <aura:if isTrue="{!v.visitRec.Account__c != null}"> 
                        
                        <!--TabOpportunities-->
                        <lightning:tab label="Opportunities">
                            <div class="dataTableMobile">
                                <aura:iteration items="{!v.relOppList}"  var="val" indexVar="index">
                                    <div class="slds-card cardmargin">
                                        <div class="cardInfo">
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Opportunity Name &nbsp;:</b>&nbsp;{!val.Name}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Stage &nbsp;:</b>&nbsp;{!val.StageName}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Close Date &nbsp;:</b>&nbsp;{!val.CloseDate}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Source &nbsp;:</b>&nbsp;{!val.LeadSource}</div>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </lightning:tab>
                        
                        <!--TabSamples1-->
                        <lightning:tab label="Samples">
                            <div class="dataTableMobile">
                                <aura:iteration items="{!v.relSampleList}"  var="val" indexVar="index">
                                    <div class="slds-card cardmargin">
                                        <div class="cardInfo">
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sample Name &nbsp;:</b>&nbsp;{!val.Name}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Status &nbsp;:</b>&nbsp;{!val.Status__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Submitted Date &nbsp;:</b>&nbsp;{!val.Sample_Submitted_Date__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Created Date &nbsp;:</b>&nbsp;{!val.CreatedDate}</div>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </lightning:tab>
                        
                        <!--TabProjects1-->
                        <lightning:tab label="Projects">
                            <div class="dataTableMobile">
                                <aura:iteration items="{!v.relProjectList}"  var="val" indexVar="index">
                                    <div class="slds-card cardmargin">
                                        <div class="cardInfo">
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Opportunity Name &nbsp;:</b>&nbsp;{!val.Name}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Status &nbsp;:</b>&nbsp;{!val.Status__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Product Family &nbsp;:</b>&nbsp;{!val.Product_Family__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Submitted Date &nbsp;:</b>&nbsp;{!val.Sample_Submitted_Date__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Created Date &nbsp;:</b>&nbsp;{!val.CreatedDate}</div>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </lightning:tab>
                        
                        <!--TabInvoices1-->
                        <lightning:tab label="Invoices">
                            <div class="dataTableMobile">
                                <aura:iteration items="{!v.relInvoicesList}"  var="val" indexVar="index">
                                    <div class="slds-card cardmargin">
                                        <div class="cardInfo">
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Invoice Number &nbsp;:</b>&nbsp;{!val.Name}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Amount &nbsp;:</b>&nbsp;{!val.Amount__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Status &nbsp;:</b>&nbsp;{!val.Status__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Initiated Amount &nbsp;:</b>&nbsp;{!val.Initiated_Amount__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Realized Amount &nbsp;:</b>&nbsp;{!val.Realized_Amount__c}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Invoice Date &nbsp;:</b>&nbsp;{!val.Invoice_Date__c}</div>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </lightning:tab>
                        
                        <!--TabTickets1-->
                        <lightning:tab label="Tickets">
                            <div class="dataTableMobile">
                                <aura:iteration items="{!v.relCaseList}"  var="val" indexVar="index">
                                    <div class="slds-card cardmargin">
                                        <div class="cardInfo">
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Sr No. &nbsp;:</b>&nbsp;<b style="color: crimson;">{!index+1}</b></div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Case Number &nbsp;:</b>&nbsp;{!val.CaseNumber}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Case Origin &nbsp;:</b>&nbsp;{!val.Origin}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Status &nbsp;:</b>&nbsp;{!val.Status}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Case Description &nbsp;:</b>&nbsp;{!val.Description}</div>
                                            <div class="slds-text-align_left slds-has-flexi-truncate"><b>Case Reason &nbsp;:</b>&nbsp;{!val.Reason}</div>
                                        </div>
                                    </div>
                                </aura:iteration>
                            </div>
                        </lightning:tab>
                        
                    </aura:if>
                    
                </lightning:tabset>
                
            </div>
        </div>
        
        <lightning:LayoutItem class="bottomdiv" padding="around-small" size="8">
            <div class="oppCardDesktop">
                <lightning:card >
                    
                    <aura:if isTrue="{!v.ShowModal}">
                        <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
                            <div class="slds-modal__container">
                                <div class="slds-modal__header">
                                    <lightning:buttonIcon iconName="utility:close"
                                                          onclick="{! c.closeModel }"
                                                          alternativeText="close"
                                                          variant="bare-inverse"
                                                          class="slds-modal__close"/>
                                </div>
                                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                                    
                                    <!--AddressPage-->
                                    <aura:if isTrue="{!v.showAddressPage}">
                                        <h3>Shipping Address</h3><br/>
                                        <div class="slds-scrollable_x">
                                            <table class="slds-table slds-table_bordered slds-table_col-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Select</th>
                                                        <th>Address Type</th>
                                                        <th>Street</th>
                                                        <th>City</th>
                                                        <th>State</th>
                                                        <th>Country</th>
                                                        <th>Pin Code</th>
                                                        <th>GST Number</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.ship_addresses}" var="address" indexVar="index">
                                                        <tr key="{!address.id}">
                                                            <td>
                                                                <input type="radio" id="{!address.id}" name="shippingOptions" checked="{!address.checked}" onclick="{!c.onAddressSelect}"  />
                                                            </td>
                                                            <td>{!address.type}</td>
                                                            <td>{!address.street}</td>
                                                            <td>{!address.city}</td>
                                                            <td>{!address.state}</td>
                                                            <td>{!address.country}</td>
                                                            <td>{!address.postalCode}</td>
                                                            <td>{!address.gstNumber}</td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Rendering the Billing Addresses -->
                                        <br/><br/>
                                        <h3>Billing Address</h3><br />
                                        <div class="slds-scrollable_x">
                                            <table class="slds-table slds-table_bordered slds-table_col-bordered">
                                                <thead>
                                                    <tr>
                                                        <th>Select</th>
                                                        <th>Address Type</th>
                                                        <th>Street</th>
                                                        <th>City</th>
                                                        <th>State</th>
                                                        <th>Country</th>
                                                        <th>Pin Code</th>
                                                        <th>GST Number</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.bill_addresses}" var="address" indexVar="index">
                                                        <tr key="{!address.id}">
                                                            <td>
                                                                <input type="radio" id="{!address.id}" name="billingOptions" checked="{!address.checked}" onclick="{!c.onBillAddressSelect}"  />
                                                            </td>
                                                            <td>{!address.type}</td>
                                                            <td>{!address.street}</td>
                                                            <td>{!address.city}</td>
                                                            <td>{!address.state}</td>
                                                            <td>{!address.country}</td>
                                                            <td>{!address.postalCode}</td>
                                                            <td>{!address.gstNumber}</td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                        
                                        <!-- Next Button -->
                                        <br/>
                                        <div class="slds-clearfix">
                                            <div class="slds-float_right">
                                                <lightning:button variant="brand" label="Next" class="slds-m-left_x-small" onclick="{!c.handleNavigate}" />
                                            </div>
                                        </div>
                                        <!--CreateOpportunityPage-->
                                        <aura:set attribute="else">
                                            <div class="slds-border_bottom slds-align_absolute-center">
                                                <h1 style="font-size:20px;">Create Opportunity</h1>
                                            </div><br/>
                                            <lightning:recordEditForm aura:id="recordOppEditForm" 
                                                                      objectApiName="Opportunity"
                                                                      onerror="{!c.handleError}"
                                                                      onsuccess="{!c.handleOppSuccess}" >
                                                <div class="slds-grid">
                                                    <div class ="slds-col slds-size_1-of-2">
                                                        <lightning:inputField fieldName="Name" value="{!v.visitRec.Account__r.Name + ' - Opportunity'}"/>
                                                        <lightning:inputField fieldName="Visit__c" value="{!v.visitRec.Id}"/>
                                                        <lightning:inputField fieldName="AccountId" value="{!v.visitRec.Account__c}"/>
                                                        <lightning:inputField fieldName="CloseDate"/>
                                                        <lightning:inputField fieldName="StageName" value="New"/>
                                                        <lightning:inputField fieldName="End_Use_Category__c"/>
                                                        <lightning:inputField fieldName="End_Use_Application__c" />                
                                                        <lightning:inputField fieldName="End_Use_Application_Other__c"/>
                                                        <lightning:inputField fieldName="LeadSource" />
                                                        <lightning:inputField fieldName="Client_Note__c"/>
                                                        <lightning:inputField fieldName="CurrencyIsoCode"/>
                                                        <lightning:inputField fieldName="Sales_Note__c" />
                                                        <lightning:inputField fieldName="Shipping_City__c" value="{!v.shipCity}"/>
                                                        <lightning:inputField fieldName="Shipping_State__c" value="{!v.shipState}"/>
                                                        <lightning:inputField fieldName="Shipping_Street__c" value="{!v.shipStreet}"/>
                                                        <lightning:inputField fieldName="Shipping_Country__c" value="{!v.shipCountry}"/>
                                                        <lightning:inputField fieldName="Shipping_Postal_Code__c" value="{!v.shipPostalCode}"/>
                                                    </div>
                                                    <div class ="slds-col slds-size_1-of-2">
                                                        <lightning:inputField fieldName="Annual_Volume_in_units__c"/>
                                                        <lightning:inputField fieldName="Annual_Volume_Full__c" />                
                                                        <lightning:inputField fieldName="Target_Price_Kg__c" />
                                                        <lightning:inputField fieldName="Primary_Contact__c" value="{!v.visitRec.Account__r.Customer_Contact__c}"/>
                                                        <lightning:inputField fieldName="Customer_Followup_Date__c"/>
                                                        <lightning:inputField fieldName="Customer_response__c"/>
                                                        <lightning:inputField fieldName="NextStep"/>
                                                        <lightning:inputField fieldName="Description"/>
                                                        <lightning:inputField fieldName="Billing_City__c" value="{!v.billCity}"/>
                                                        <lightning:inputField fieldName="Billing_State__c" value="{!v.billState}"/>
                                                        <lightning:inputField fieldName="Billing_Street__c" value="{!v.billStreet}"/>
                                                        <lightning:inputField fieldName="Billing_Country__c" value="{!v.billCountry}"/>
                                                        <lightning:inputField fieldName="Billing_Postal_Code__c" value="{!v.billPostalCode}"/> 
                                                        <lightning:inputField fieldName="Customer_Shipping_Address__c" value="{!v.customShipAdrsId}"/>
                                                        <lightning:inputField fieldName="Account_Shipping_Address__c" value="{!v.accShipAdrs}"/>
                                                        <lightning:inputField fieldName="Customer_Billing_Address__c" value="{!v.customBillAdrsId}"/>
                                                        <lightning:inputField fieldName="Account_Billing_Address__c" value="{!v.accBillAdrs}"/>
                                                    </div>
                                                </div> 
                                                <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                                    <lightning:button label="Cancel" onclick="{!c.onCancel}" class="slds-m-top_small" />
                                                    <lightning:button label="Save" variant="brand" onclick="{!c.handleOppSubmit}" class="slds-m-top_small" />
                                                </div>  
                                            </lightning:recordEditForm> 
                                        </aura:set>
                                    </aura:if>               
                                    
                                </div>
                            </div>
                        </section>
                        <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>   
                    </aura:if>
                    
                    <lightning:LayoutItem size="12" class="buttonCard">
                        <div class="buttonGroupCardDesktop">
                            <lightning:Layout>
                                <lightning:LayoutItem padding="around-small" size="12">
                                    <!-- <aura:if isTrue="{!v.visitRec.Account__c != null}">
                                        <lightning:button onclick="{!c.createCaseHanlde}" label="New Ticket" class="visitMainButtons"/>
                                        <lightning:button onclick="{!c.createOpportunityHandle}" label="New Opportunity" class="visitMainButtons"/>
                                    </aura:if> -->
                                    <lightning:button onclick="{!c.UpdateVisitDetails}" label="Update Visit" class="visitMainButtons"/>
                                    <lightning:button onclick="{!c.checkOutHandler}" label="Check-Out" disabled="{!v.ShowCheckOutButton}" class="visitMainButtons"/>
                                    <lightning:button onclick="{!c.checkInHandler}" label="Check-In" disabled="{!v.ShowCheckInButton}" class="visitMainButtons"/>
                                </lightning:LayoutItem>
                            </lightning:Layout>
                            <lightning:Layout>  
                            </lightning:Layout>
                        </div>
                    </lightning:LayoutItem>
                    
                    <div class="dataTableDesktop">
                        <lightning:LayoutItem size="12" class="">
                            <lightning:tabset>
                                <!--TabActivity-->
                                <lightning:tab label="Activity">
                                    <div class="slds-m-around--xx-small slds-scrollable">
                                        <div class="container-fluid">
                                            <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                <thead>
                                                    <tr class="slds-text-title_caps" >
                                                        <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">S No.</div>
                                                        </th>
                                                        <th scope="col" title="Due Date" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Due Date</div>
                                                        </th>
                                                        <th scope="col" title="Priority" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Priority</div>
                                                        </th>
                                                        <th scope="col" title="Status" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Status</div>
                                                        </th>
                                                        <th scope="col" title="Subject" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Subject</div>
                                                        </th>
                                                        <th scope="col" title="Type" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Type</div>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.relActivityList}" var="pastVisitRec" indexVar="index">
                                                        <tr>
                                                            <td style="background-color:#F5F5F5;">
                                                                <h2>{!index+1}</h2>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.ActivityDate}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Priority}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Status}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Subject}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Type}
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </lightning:tab>
                                
                                <!--TabPastVisits-->
                                <lightning:tab label="Past Visits">
                                    <div class="slds-m-around--xx-small slds-scrollable">
                                        <div class="container-fluid">
                                            <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                <thead>
                                                    <tr class="slds-text-title_caps" >
                                                        <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">S No.</div>
                                                        </th>
                                                        <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Type</div>
                                                        </th>
                                                        <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Id</div>
                                                        </th>
                                                        <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Date</div>
                                                        </th>
                                                        <th scope="col" title="Visit Duration" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Duration</div>
                                                        </th>
                                                        <th scope="col" title="Visit Time" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Time</div>
                                                        </th>
                                                        <th scope="col" title="Visit Status" style="background-color:#6CA1E9;">
                                                            <div class="slds-truncate">Visit Status</div>
                                                        </th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <aura:iteration items="{!v.pastVisitList}" var="pastVisitRec" indexVar="index">
                                                        <tr>
                                                            <td style="background-color:#F5F5F5;">
                                                                <h2>{!index+1}</h2>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.KPI_Target_Name__c}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Name}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Actual_visit_date__c}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Duration__c}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Visit_Time__c}
                                                                </div>
                                                            </td>
                                                            <td style="background-color:#F5F5F5;">
                                                                <div>
                                                                    {!pastVisitRec.Visit_Status__c}
                                                                </div>
                                                            </td>
                                                        </tr>
                                                    </aura:iteration>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </lightning:tab>
                                
                                <aura:if isTrue="{!v.visitRec.Account__c != null}"> 
                                    <!--TabOpportunities-->
                                    <lightning:tab label="Opportunities">
                                        <div class="slds-m-around--xx-small slds-scrollable">
                                            <div class="container-fluid">
                                                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                    <thead>
                                                        <tr class="slds-text-title_caps" >
                                                            <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">S No.</div>
                                                            </th>
                                                            <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Opportunity Name</div>
                                                            </th>
                                                            <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Stage</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Close Date</div>
                                                            </th>
                                                            <th scope="col" title="Visit Duration" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Source</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.relOppList}" var="val" indexVar="index">
                                                            <tr>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <h2>{!index+1}</h2>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div data-id="{!val.Id}" onclick="{!c.handleOppClick}" style="cursor:pointer;">
                                                                        <h2 style="color: blue; text-decoration: underline;"> {!val.Name}</h2>
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.StageName}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.CloseDate}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.LeadSource}
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </aura:iteration>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </lightning:tab>
                                    
                                    <!--TabSamples-->
                                    <lightning:tab label="Samples">
                                        <div class="slds-m-around--xx-small slds-scrollable">
                                            <div class="container-fluid">
                                                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                    <thead>
                                                        <tr class="slds-text-title_caps" >
                                                            <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">S No.</div>
                                                            </th>
                                                            <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Sample Name</div>
                                                            </th>
                                                            <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Status</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Submitted Date</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Created Date</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.relSampleList}" var="val" indexVar="index">
                                                            <tr>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <h2>{!index+1}</h2>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div data-id="{!val.Id}" onclick="{!c.handleOppClick}" style="cursor:pointer;">
                                                                        <h2 style="color: blue; text-decoration: underline;"> {!val.Name}</h2>
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Status__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Sample_Submitted_Date__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.CreatedDate}
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </aura:iteration>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </lightning:tab>
                                    
                                    <!--TabProjects-->
                                    <lightning:tab label="Projects">
                                        <div class="slds-m-around--xx-small slds-scrollable">
                                            <div class="container-fluid">
                                                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                    <thead>
                                                        <tr class="slds-text-title_caps" >
                                                            <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">S No.</div>
                                                            </th>
                                                            <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Project Name</div>
                                                            </th>
                                                            <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Status</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Product Family</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Submitted Date</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Created Date</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.relProjectList}" var="val" indexVar="index">
                                                            <tr>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <h2>{!index+1}</h2>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div data-id="{!val.Id}" onclick="{!c.handleOppClick}" style="cursor:pointer;">
                                                                        <h2 style="color: blue; text-decoration: underline;"> {!val.Name}</h2>
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Status__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Product_Family__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Sample_Submitted_Date__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.CreatedDate}
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </aura:iteration>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </lightning:tab>
                                    
                                    <!--TabInvoices-->
                                    <lightning:tab label="Invoices">
                                        <div class="slds-m-around--xx-small slds-scrollable">
                                            <div class="container-fluid">
                                                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                    <thead>
                                                        <tr class="slds-text-title_caps" >
                                                            <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">S No.</div>
                                                            </th>
                                                            <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Invoice Number</div>
                                                            </th>
                                                            <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Amount</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Status</div>
                                                            </th>
                                                            <th scope="col" title="Visit Duration" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Initiated Amount</div>
                                                            </th>
                                                            <th scope="col" title="Visit Time" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Realized Amount</div>
                                                            </th>
                                                            <th scope="col" title="Visit Status" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Invoice Date</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.relInvoicesList}" var="val" indexVar="index">
                                                            <tr>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <h2>{!index+1}</h2>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Name}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Amount__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Status__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Initiated_Amount__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Realized_Amount__c}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Invoice_Date__c}
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </aura:iteration>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </lightning:tab>
                                    
                                    <!--TabTickets-->
                                    <lightning:tab label="Tickets">
                                        <div class="slds-m-around--xx-small slds-scrollable">
                                            <div class="container-fluid">
                                                <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                                                    <thead>
                                                        <tr class="slds-text-title_caps" >
                                                            <th scope="col" title="sNo" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">S No.</div>
                                                            </th>
                                                            <th scope="col" title="Visit Type" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Case Number</div>
                                                            </th>
                                                            <th scope="col" title="Visit Id" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Case Origin</div>
                                                            </th>
                                                            <th scope="col" title="Visit Date" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Status</div>
                                                            </th>
                                                            <th scope="col" title="Visit Duration" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Case Description</div>
                                                            </th>
                                                            <th scope="col" title="Visit Time" style="background-color:#6CA1E9;">
                                                                <div class="slds-truncate">Case Reason</div>
                                                            </th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <aura:iteration items="{!v.relCaseList}" var="val" indexVar="index">
                                                            <tr>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <h2>{!index+1}</h2>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.CaseNumber}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Origin}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Status}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Description}
                                                                    </div>
                                                                </td>
                                                                <td style="background-color:#F5F5F5;">
                                                                    <div>
                                                                        {!val.Reason}
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                        </aura:iteration>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </lightning:tab>
                                    
                                </aura:if>
                                
                            </lightning:tabset>
                        </lightning:LayoutItem>
                    </div>
                    
                </lightning:card>
            </div>
        </lightning:LayoutItem>
        
        <lightning:LayoutItem  size="4">
            <div class="DesktopMapCard">
                <lightning:Layout>
                    <lightning:LayoutItem size="12">
                        <c:mapcontainer recordId="{!v.accID}"  class="map"/>
                    </lightning:LayoutItem>
                </lightning:Layout>
            </div>
        </lightning:LayoutItem>
        
        <!--CreateTaskPage-->
        <aura:if isTrue="{!v.showCreateTask}">
            <div>
                <section role="dialog" tabindex="-1" aria-label="Meaningful description of the modal content" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container" >
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="{!c.closeActivityCreate}">
                                <lightning:icon iconName="utility:close" size="small" variant="neutral"/>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </header>
                        <center style="background: white;"><b>New Task</b></center>
                        <div class="slds-modal__content slds-p-around_medium alignLeft" id="modal-content-id-1">
                            <div class="row">
                                <lightning:input name="taskSubject" label="Subject" required="true" value="{!v.taskRec.Subject}"/>
                                <lightning:input name="taskComment" label="Comment" value="{!v.taskRec.Description}"/> 
                                <lightning:select aura:id="fieldStatus" label="Status"  required="true" onchange="{!c.onChangeHandlerStatus}" value="{!v.taskRec.Status}">
                                    <option value="">--None--</option>
                                    <aura:iteration items="{!v.StatuspickValues}" var="val">
                                        <option value="{!val}"> {!val}</option>
                                    </aura:iteration>
                                </lightning:select>
                                <lightning:select aura:id="fieldPrority" label="Priority"  required="true" onchange="{!c.onChangeHandlerPriority}" value="{!v.taskRec.Priority}">
                                    <option value="">--None--</option>
                                    <aura:iteration items="{!v.PrioritypickValues}" var="val">
                                        <option value="{!val}"> {!val}</option>
                                    </aura:iteration>
                                </lightning:select>
                                <lightning:input type="date" name="taskduedate" label="Due Date" value="{!v.taskRec.ActivityDate}"/>
                            </div>
                        </div>
                        <footer class="slds-modal__footer">
                            <div class="slds-align_absolute-center">
                                <lightning:button label="Cancel" variant="destructive" class="slds-m-top--medium"   onclick="{!c.closeActivityCreate}"/>
                                <lightning:button label="Submit" variant="brand" class="slds-m-top--medium" onclick="{!c.saveTaskHandler}"/>
                            </div>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:if>
        
        <!--CreateLogTaskPage-->
        <aura:if isTrue="{!v.showCreateCallLogTask}">
            <div>
                <section role="dialog" tabindex="-1" aria-label="Meaningful description of the modal content" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container" >
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="{!c.closeCallLogCreate}">
                                <lightning:icon iconName="utility:close" size="small" variant="neutral"/>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </header>
                        <center style="background: white;"><b>Log a call</b></center>
                        <div class="slds-modal__content slds-p-around_medium alignLeft" id="modal-content-id-1">
                            <div class="row">
                                <lightning:input name="taskSubject" label="Subject" required="true" value="{!v.callRec.Subject}"/> 
                                <lightning:input type="text" name="taskcomments" label="Comments" value="{!v.callRec.Description}"/>
                            </div>
                        </div>
                        <footer class="slds-modal__footer">
                            <div class="slds-align_absolute-center">
                                <lightning:button label="Cancel" variant="destructive" class="slds-m-top--medium"   onclick="{!c.closeCallLogCreate}"/>
                                <lightning:button label="Submit" variant="brand" class="slds-m-top--medium" onclick="{!c.saveLogCall}"/>
                            </div>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:if>
        
        <!--CaseCreatePage-->
        <aura:if isTrue="{!v.showCreateCase}">
            <div>
                <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container">
                        <div class="slds-modal__header">
                            <lightning:buttonIcon iconName="utility:close"
                                                  onclick="{! c.closeModel }"
                                                  alternativeText="close"
                                                  variant="bare-inverse"
                                                  class="slds-modal__close"/>
                        </div>
                        <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                            <div class="slds-border_bottom slds-align_absolute-center">
                                <h1 style="font-size:20px;">New Case: Internal Issues</h1>
                            </div><br/>
                            <lightning:recordEditForm aura:id="recordCaseEditForm" 
                                                      objectApiName="Case"
                                                      onerror="{!c.handleError}"
                                                      onsuccess="{!c.createCaseHandle}" >
                                <div class="slds-grid">
                                    <div class="slds-col slds-size_2-of-2">
                                        <lightning:inputField fieldName="ContactId"/>
                                        <lightning:inputField fieldName="AccountId" value="{!v.accID}" disabled="true"/>
                                        <lightning:inputField fieldName="Status" value="New"/>
                                        <lightning:inputField fieldName="Type"/>
                                        <lightning:inputField fieldName="RecordTypeId" value="0125j000001Nht6AAC" disabled="true"/>
                                        <lightning:inputField fieldName="Origin"/>
                                        <lightning:inputField fieldName="Reason"/>
                                        <lightning:inputField fieldName="Priority" />                
                                        <lightning:inputField fieldName="Subject"/>
                                        <lightning:inputField fieldName="Description" />
                                        <lightning:inputField fieldName="Comments"/>
                                        <lightning:inputField fieldName="Product_addition__c"/>
                                        <lightning:inputField fieldName="User_Creation_Request__c" />
                                        <lightning:inputField fieldName="SuppliedEmail"/>
                                    </div> 
                                </div>
                                <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                    <lightning:button label="Cancel" onclick="{!c.closeCaseHanlde}" class="slds-m-top_small" />
                                    <lightning:button label="Save" variant="brand" onclick="{!c.handleCaseSubmit}" class="slds-m-top_small" />
                                </div>  
                            </lightning:recordEditForm> 
                        </div>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:if>
        
        <!--OpportunityCreatePage-->
        <aura:if isTrue="{!v.showOpportunityCreate}">
            <div>
                <section role="dialog" tabindex="-1" aria-label="Meaningful description of the modal content" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
                    <div class="slds-modal__container" >
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="{!c.closeOpportunityHandle}">
                                <lightning:icon iconName="utility:close" size="small" variant="neutral"/>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </header>
                        <center style="background: white;"><b>New Opportunity</b></center>
                        <div class="slds-modal__content slds-p-around_medium alignLeft" id="modal-content-id-1">
                            <div class="row">
                                <lightning:input name="RequestName" label="Opportunity Name" required="true" value="{!v.oppRec.Name}"/> 
                                <lightning:select aura:id="fieldOppStage" label="Status"  required="true" onchange="{!c.onChangeHandlerOppStage}" value="{!v.oppRec.StageName}">
                                    <option value="">--None--</option>
                                    <aura:iteration items="{!v.OppStageNamepickValues}" var="val">
                                        <option value="{!val}"> {!val}</option>
                                    </aura:iteration>
                                </lightning:select>
                                <lightning:input type="date" name="oppclosedate" required="true" label="Close Date" value="{!v.oppRec.CloseDate}"/>
                            </div>
                        </div>
                        <footer class="slds-modal__footer ">
                            <div class="slds-align_absolute-center">
                                <lightning:button label="Cancel" variant="destructive" class="slds-m-top--medium"   onclick="{!c.closeOpportunityHandle}"/>
                                <lightning:button label="Submit" variant="brand" class="slds-m-top--medium" onclick="{!c.createOppHandle}"/>
                            </div>
                        </footer>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
        </aura:if>
        
        <!--UpdateVisitPage-->
        <aura:if isTrue="{!v.ShowUpdateVisitPage}">

            <div>
                <section role="dialog" tabindex="-1" aria-label="Meaningful description of the modal content" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_small">
                    <div class="slds-modal__container" >
                        <header class="slds-modal__header">
                            <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick="{!c.onCancelVisitUpdatePage}">
                                <lightning:icon iconName="utility:close" size="small" variant="neutral"/>
                                <span class="slds-assistive-text">Close</span>
                            </button>
                        </header>
                        <center style="background: rgb(224, 166, 124);font-size: 20px;padding: 5px;"><b>Update Visit Details</b></center>
                        <div class="slds-modal__content slds-p-around_medium alignLeft" id="modal-content-id-1">  
                                <div class="slds-section slds-is-open">
                                    <h3 class="slds-section__title"> 
                                        <span class="slds-truncate slds-size_12-of-12" title="Section Title" style="Background-color:#F3F3F3;border-radius:0.25rem;padding:3px;"><b>Basic Details</b></span>
                                    </h3>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitname" value="{!v.visitRec.Name}" label="Name"  disabled="true"  />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:select aura:id="visitStatus" label="Select Status"  onchange="{!c.onChangeVisitStatusHandler}">
                                            <option value="{!v.visitRec.Visit_Status__c}">{!v.visitRec.Visit_Status__c}</option>
                                            <aura:iteration items="{!v.VisitStautspickValues}" var="val">
                                                <option value="{!val}"> {!val}</option>
                                            </aura:iteration>
                                        </lightning:select>
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="plannedVisitDate" type="date" label="Planned Visit Date" value="{!v.visitRec.Planned_visit_date__c}" />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="actualVisitDate" type="date" label="Actual Visit Date" value="{!v.visitRec.Actual_visit_date__c}" />
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="expectedStartTime" type="time" label="Start Time" value="{!v.visitRec.Expected_Start_Time__c}" />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="expectedEndTime" type="time" label="End Time" value="{!v.visitRec.Expected_End_Time__c}" />
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="specifierId" label="Specifier Name" value="{!v.visitRec.Specifier__r.Name}" disabled="true"   />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitdescription" label="Description" value="{!v.visitRec.Description__c}" />
                                    </div>
                                </div>
                                <div class="slds-section slds-is-open">
                                    <h3 class="slds-section__title"> 
                                        <span class="slds-truncate slds-size_12-of-12" title="Section Title" style="Background-color:#F3F3F3;border-radius:0.25rem;padding:3px;"><b>Address Details</b></span>
                                    </h3>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitstreet" label="Street" value="{!v.visitRec.Street__c}" />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitpostalCode" label="Postal Code" value="{!v.visitRec.Postal_Code__c}" />
                                    </div>
                                </div>
                                <div class="slds-grid slds-gutters">
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitcity" label="City" value="{!v.visitRec.City__c}" />
                                    </div>
                                    <div class="slds-col slds-size_1-of-2">
                                        <lightning:input aura:id="visitstate" label="State" value="{!v.visitRec.State__c}" />
                                    </div>
                                </div>
                                <div class="slds-align_absolute-center slds-border_top" slot="footer">
                                    <lightning:button label="Cancel" variant="destructive" onclick="{!c.onCancelVisitUpdatePage}" class="slds-m-top_small slds-m-right_small" />
                                    <lightning:button label="Update Details" variant="brand" onclick="{!c.handleUpdateVisitSuccess}" class="slds-m-top_small" />
                                </div> 
                        </div>
                    </div>
                </section>
                <div class="slds-backdrop slds-backdrop_open"></div>
            </div>
            
        </aura:if>
        
    </lightning:Layout>
    
</aura:component>